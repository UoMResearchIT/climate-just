!function(window,document,undefined){"use strict";function Fa(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function Ia(e){var t,n,r=!document.addEventListener||!document.querySelector;if(!window.ActiveXObject||window.XMLHttpRequest&&!r)window.XMLHttpRequest&&(t=new window.XMLHttpRequest);else for(var o=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],i=0,a=o.length;i<a;i++)try{t=new window.ActiveXObject(o[i])}catch(e){}t||(n=new Error("Your browser doesn't support neither 'XMLHttpRequest' nor 'ActiveXObject'")),r=void 0!==t.withCredentials,!function(e){if("string"!=typeof e)return!1;var t=window.location,n=document.createElement("a");return n.href=e,""!==n.protocol&&t.protocol!==n.protocol||(""!==n.hostname&&t.hostname!==n.hostname||""!==n.port&&t.port!==n.port)}(e)||r||(window.XDomainRequest?this.xdr=new window.XDomainRequest:n=new Error("Your browser doesn't support cross-domain requests")),this.url=e,this.xhr=t,this.xdr=void 0,this.error=n}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError("'this' is null or not defined");var r=Object(this),o=r.length>>>0;if(0==o)return-1;t|=0;if(o<=t)return-1;for(n=Math.max(0<=t?t:o-Math.abs(t),0);n<o;){if(n in r&&r[n]===e)return n;n++}return-1}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,o;if(null==this)throw new TypeError("'this' is null or not defined");var i,a=Object(this),l=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(n=t),r=new Array(l),o=0;o<l;)o in a&&(i=a[o],i=e.call(n,i,o,a),r[o]=i),o++;return r}),L.TileLayer.WMS.Util={},L.TileLayer.WMS.Util.JSON={parse:window.JSON?window.JSON.parse:function(jsonString){return eval("("+jsonString+")")}},L.TileLayer.WMS.Util.XML={parse:function(e){var t;try{window.DOMParser?t=(new window.DOMParser).parseFromString(e,"text/xml"):window.ActiveXObject&&((t=new window.ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=null}if(!t||!t.documentElement)throw new Error("Unable to parse specified 'xmlString' it isn't valid");var n=t.getElementsByTagName("parsererror");if(0<n.length){for(var r="",o=0,i=n.length;o<i;o++){var a=n[o];r+=L.TileLayer.WMS.Util.XML.getElementText(a).trim(),o<i-1&&(r+=" ")}throw new Error("Unable to parse specified 'xmlString' it isn't valid: "+r)}return L.TileLayer.WMS.Util.XML.normalizeElement(t.documentElement)},getElementText:function(e){return e?e.innerText||e.textContent||e.text:""},normalizeElement:function(e){var t,n;for(3===e.nodeType&&""===L.TileLayer.WMS.Util.XML.getElementText(e).trim()&&e.parentNode&&e.parentNode.removeChild(e),t=e.firstChild;t;)n=t.nextSibling,L.TileLayer.WMS.Util.XML.normalizeElement(t),t=n;return e},extractInfoFormats:function(e){var t=[];if(e)for(var n=e.getElementsByTagName("Capability")[0].getElementsByTagName("GetFeatureInfo")[0].getElementsByTagName("Format"),r=0,o=n.length;r<o;r++){var i=n[r];t.push(L.TileLayer.WMS.Util.XML.getElementText(i).trim().toLowerCase())}return t}},L.TileLayer.WMS.Util.XML.ExceptionReport={getExisting:function(){var e,t=[],n=L.TileLayer.WMS.Util.XML.ExceptionReport;for(e in n){var r=n.hasOwnProperty(e)?n[e]:null;r&&"object"==typeof r&&"function"==typeof r.parse&&t.push(r)}return t},parse:function(e){for(var t=L.TileLayer.WMS.Util.XML.ExceptionReport.getExisting(),n=null,r=0,o=t.length;r<o;r++)if(n=t[r].parse(e))break;return n}},L.TileLayer.WMS.Util.XML.ExceptionReport.OWS={parse:function(e){if("string"!=typeof e||e.indexOf("<ows:ExceptionReport")<0)return null;e=L.TileLayer.WMS.Util.XML.parse(e);if(!e||"ows:ExceptionReport"!==e.tagName)return null;for(var t={exceptions:[],message:""},n=e.getElementsByTagName("Exception"),r=0,o=n.length;r<o;r++){for(var i=n[r],a=i.getAttribute("exceptionCode"),l=i.getElementsByTagName("ExceptionText"),s={code:a,text:""},u=0,c=l.length;u<c;u++){var f=l[u],f=L.TileLayer.WMS.Util.XML.getElementText(f).trim();s.text+=f,u<c-1&&(s.text+=" ")}t.message+=(s.code?s.code+" - ":"")+s.text+". ",t.exceptions.push(s)}return t}},L.TileLayer.WMS.Util.XML.ExceptionReport.Service={parse:function(e){if("string"!=typeof e||e.indexOf("<ServiceExceptionReport")<0)return null;e=L.TileLayer.WMS.Util.XML.parse(e);if(!e||"ServiceExceptionReport"!==e.tagName)return null;for(var t={exceptions:[],message:""},n=e.getElementsByTagName("ServiceException"),r=0,o=n.length;r<o;r++){var i=n[r],a=i.getAttribute("code"),i={code:a,text:(a?a+" - ":"")+L.TileLayer.WMS.Util.XML.getElementText(i).trim()+". "};t.message+=i.text,t.exceptions.push(i)}return t}},L.TileLayer.WMS.Util.XML.ExceptionReport.Exception={parse:function(e){if("string"!=typeof e||e.indexOf("<ExceptionReport")<0)return null;e=L.TileLayer.WMS.Util.XML.parse(e);if(!e||"ExceptionReport"!==e.tagName)return null;for(var t={exceptions:[],message:""},n=e.getElementsByTagName("Exception"),r=0,o=n.length;r<o;r++){for(var i=n[r],a=i.getAttribute("exceptionCode"),l=i.getElementsByTagName("ExceptionText"),s={code:a,text:""},u=0,c=l.length;u<c;u++){var f=l[u],f=L.TileLayer.WMS.Util.XML.getElementText(f).trim();s.text+=f,u<c-1&&(s.text+=" ")}t.message+=(s.code?s.code+" - ":"")+s.text+". ",t.exceptions.push(s)}return t}},Ia.prototype.send=function(t){t=function(){for(var e,t,n,r=0,o=arguments.length;r<o;r++)for(e in n=n||{},t=arguments[r])n[e]=t[e];return n}({method:"GET",headers:null,content:null,done:function(e,t){},fail:function(e,t){throw e},always:function(){}},t||{});function e(){"function"==typeof t.done&&t.done(o.responseText,o),"function"==typeof t.always&&t.always()}function r(e){"function"==typeof t.fail&&t.fail(e,o),"function"==typeof t.always&&t.always()}var o=this.xdr||this.xhr;if(this.error)r(this.error);else if("string"==typeof t.method&&(t.method=t.method.trim().toUpperCase()),"GET"!==t.method&&"DELETE"!==t.method||(this.url=function(e,t){var n,r=[];for(n in t=t||{})r.push(Fa(n)+"="+Fa(t[n]));return(e=e||"")+(-1===e.indexOf("?")?"?":"&")+r.join("&")}(this.url,t.content),t.content=null,t.headers&&t.headers["Content-type"]&&delete t.headers["Content-type"]),o===this.xdr)o.open(t.method,this.url),o.onload=e,o.onerror=r,o.send(t.content);else{if(o.onreadystatechange=function(){var t,n;try{if(4!==o.readyState)return;t=1223===o.status?204:o.status}catch(e){t=0,n=e}200<=t&&t<300?e():r(n||new Error(t+" - "+o.responseText))},o.open(t.method,this.url,!0),t.headers)for(var n in t.headers)t.headers.hasOwnProperty(n)&&o.setRequestHeader(n,t.headers[n]);o.send(t.content)}},L.TileLayer.WMS.Util.AJAX=function(e){new Ia(e.url).send(e)},L.TileLayer.WMS.Format={getExisting:function(){var e,t=[],n=L.TileLayer.WMS.Format;for(e in n){var r=n.hasOwnProperty(e)?n[e]:null;r&&"object"==typeof r&&"function"==typeof r.toGeoJSON&&t.push(e)}return t.sort(function(e,t){e=L.TileLayer.WMS.Format[e],t=L.TileLayer.WMS.Format[t];return e.priority>t.priority?1:e.priority<t.priority?-1:0}),t},getAvailable:function(u){u=L.Util.extend({fail:function(e){throw e}},u||{});function c(e,t){"function"==typeof u.fail&&u.fail.call(window,e,t),"function"==typeof u.always&&u.always.call(window)}L.TileLayer.WMS.Util.AJAX({url:u.url,method:"GET",content:{request:"GetCapabilities",service:"WMS",version:u.wmsParams&&u.wmsParams.version||"1.1.0"},done:function(e,t){try{var n=L.TileLayer.WMS.Util.XML.ExceptionReport.parse(e);if(n)throw new Error(n.message);for(var r=L.TileLayer.WMS.Util.XML.parse(e),o=L.TileLayer.WMS.Util.XML.extractInfoFormats(r),i=L.TileLayer.WMS.Format.getExisting(),a=[],l=0;l<i.length;l++){var s=i[l];0<=o.indexOf(s)&&a.push(s)}n=a,r=t,"function"==typeof u.done&&u.done.call(window,n,r),"function"==typeof u.always&&u.always.call(window)}catch(e){c(e,t)}},fail:c})}},L.TileLayer.WMS.Format["application/geojson"]={priority:1,toGeoJSON:function(e){return L.TileLayer.WMS.Util.JSON.parse(e)}},L.TileLayer.WMS.Format["application/json"]={priority:2,toGeoJSON:function(e){return L.TileLayer.WMS.Format["application/geojson"].toGeoJSON(e)}},L.TileLayer.WMS.Format["application/vnd.ogc.gml/3.1.1"]={priority:3,toGeoJSON:function(e){return L.TileLayer.WMS.Format["application/vnd.ogc.gml"].toGeoJSON(e)}},function(){var l="http://www.opengis.net/gml",p=".",c=",",g=" ",s=["gml:Point","gml:MultiPoint","gml:LineString","gml:MultiLineString","gml:Polygon","gml:MultiPolygon"],u={toGeoJSON:function(e){return u[e.tagName].toGeoJSON(e)},"wfs:FeatureCollection":{toGeoJSON:function(e){return u["gml:featureCollection"].toGeoJSON(e)}},"gml:featureCollection":{toGeoJSON:function(e){for(var t={type:"FeatureCollection",features:[]},n=e.getElementsByTagNameNS(l,"featureMember"),r=0,o=n.length;r<o;r++){var i=n[r],i=u.toGeoJSON(i);t.features.push(i)}return t}},"gml:featureMember":{toGeoJSON:function(e){for(var t={type:"Feature",geometry:null,properties:{}},n=e.firstChild.childNodes,r=0,o=n.length;r<o;r++){var i=n[r],a=i.tagName.split(":")[1],l=i.firstChild;l&&0<=s.indexOf(l.tagName)?t.geometry=u.toGeoJSON(l):t.properties[a]=L.TileLayer.WMS.Util.XML.getElementText(i)||null}return t}},"gml:coord":{toGeoJSON:function(e){function t(e){e=window.parseFloat(L.TileLayer.WMS.Util.XML.getElementText(e).trim()),n.push(e)}var n=[];t(e.getElementsByTagNameNS(l,"X")[0]),t(e.getElementsByTagNameNS(l,"Y")[0]);e=e.getElementsByTagNameNS(l,"Z")[0];return e&&t(e),n}},"gml:coordinates":{toGeoJSON:function(e){for(var t=e.attributes,n=t.decimal&&t.decimal.value||p,r=t.cs&&t.cs.value||c,t=t.ts&&t.ts.value||g,o=[],i=L.TileLayer.WMS.Util.XML.getElementText(e).trim().replace(new RegExp("\\s*"+r+"\\s*","gi"),r).split(t),a=function(e){return"."!==n&&(e=e.replace(n,".")),window.parseFloat(e)},l=0,s=i.length;l<s;l++){var u=i[l].split(r).map(a);o.push(u)}return 1<o.length?o:o[0]}},"gml:pos":{toGeoJSON:function(e){var t=e.attributes,n=t.decimal&&t.decimal.value||p,t=t.ts&&t.ts.value||g;return L.TileLayer.WMS.Util.XML.getElementText(e).trim().split(t).map(function(e){return"."!==n&&(e=e.replace(n,".")),window.parseFloat(e)})}},"gml:posList":{toGeoJSON:function(e){for(var t=e.attributes,n=t.decimal&&t.decimal.value||p,r=t.ts&&t.ts.value||g,o=window.parseInt((t.srsDimension||t.dimension||{}).value,10)||2,i=[],a=L.TileLayer.WMS.Util.XML.getElementText(e).trim().split(r),l=0,s=a.length;l<s;l+=o){for(var u=[],c=l,f=l+o;c<f;c++){var m=a[c];"."!==n&&(m=m.replace(n,".")),u.push(window.parseFloat(m))}i.push(u)}return i}},"gml:Point":{toGeoJSON:function(e){var t={type:"Point",coordinates:[]},e=e.firstChild;return t.coordinates=u.toGeoJSON(e),t}},"gml:MultiPoint":{toGeoJSON:function(e){for(var t={type:"MultiPoint",coordinates:[]},n=e.getElementsByTagNameNS(l,"Point"),r=0,o=n.length;r<o;r++){var i=n[r],i=u.toGeoJSON(i).coordinates;t.coordinates.push(i)}return t}},"gml:LineString":{toGeoJSON:function(e){var t,n={type:"LineString",coordinates:[]},r=e.childNodes;if(1===r.length)t=r[0],n.coordinates=u.toGeoJSON(t);else for(var o=0,i=r.length;o<i;o++)t=r[o],n.coordinates.push(u.toGeoJSON(t));return n}},"gml:MultiLineString":{toGeoJSON:function(e){for(var t={type:"MultiLineString",coordinates:[]},n=e.getElementsByTagNameNS(l,"LineString"),r=0,o=n.length;r<o;r++){var i=n[r],i=u.toGeoJSON(i).coordinates;t.coordinates.push(i)}return t}},"gml:LinearRing":{toGeoJSON:function(e){return u["gml:LineString"].toGeoJSON(e).coordinates}},"gml:Polygon":{toGeoJSON:function(e){var t={type:"Polygon",coordinates:[]},n=e.getElementsByTagNameNS(l,"exterior");0===n.length&&(n=e.getElementsByTagNameNS(l,"outerBoundaryIs"));n=n[0].getElementsByTagNameNS(l,"LinearRing")[0],n=u.toGeoJSON(n);t.coordinates.push(n);var r=e.getElementsByTagNameNS(l,"interior");0===r.length&&(r=e.getElementsByTagNameNS(l,"innerBoundaryIs"));for(var o=0,i=r.length;o<i;o++){var a=r[o].getElementsByTagNameNS(l,"LinearRing")[0],a=u.toGeoJSON(a);t.coordinates.push(a)}return t}},"gml:MultiPolygon":{toGeoJSON:function(e){for(var t={type:"MultiPolygon",coordinates:[]},n=e.getElementsByTagNameNS(l,"Polygon"),r=0,o=n.length;r<o;r++){var i=n[r],i=u.toGeoJSON(i).coordinates;t.coordinates.push(i)}return t}}};L.TileLayer.WMS.Format["application/vnd.ogc.gml"]={priority:4,toGeoJSON:function(e){e=L.TileLayer.WMS.Util.XML.parse(e);return u.toGeoJSON(e)}}}(),L.TileLayer.WMS.Format["text/xml"]={priority:5,toGeoJSON:function(e){return L.TileLayer.WMS.Format["application/vnd.ogc.wms_xml"].toGeoJSON(e)}},L.TileLayer.WMS.Format["application/vnd.ogc.wms_xml"]={priority:6,toGeoJSON:function(e){for(var t={type:"FeatureCollection",features:[]},n=L.TileLayer.WMS.Util.XML.parse(e).getElementsByTagName("FIELDS"),r=0,o=n.length;r<o;r++){var i,a,l={type:"Feature",geometry:null,properties:{}},s=n[r].attributes;for(i in s)!s.hasOwnProperty(i)||(a=s[i])&&a.name&&(l.properties[a.name]=a.value||null);t.features.push(l)}return t}},L.TileLayer.WMS.Format["text/html"]={priority:7,toGeoJSON:function(e){var t={type:"FeatureCollection",features:[]},e=L.TileLayer.WMS.Util.XML.parse(e).getElementsByTagName("table")[0];if(!e)return t;for(var n=[],r=e.getElementsByTagName("th"),o=0,i=r.length;o<i;o++){var a=r[o];n.push(L.TileLayer.WMS.Util.XML.getElementText(a))}for(var l=e.getElementsByTagName("tr"),s=0,u=l.length;s<u;s++){var c=l[s].getElementsByTagName("td");if(c.length===n.length){for(var f={type:"Feature",geometry:null,properties:{}},m=0,p=c.length;m<p;m++){var g=c[m];f.properties[n[m]]=L.TileLayer.WMS.Util.XML.getElementText(g)||null}t.features.push(f)}}return t}},L.TileLayer.WMS.include({_boundingBox:null,getBoundingBox:function(x){x=L.Util.extend({fail:function(e){throw e}},x||{});function E(e,t){"function"==typeof x.done&&x.done.call(W,e,t),"function"==typeof x.always&&x.always.call(W)}function N(e,t){"function"==typeof x.fail&&x.fail.call(W,e,t),"function"==typeof x.always&&x.always.call(W)}var W=this,O=W._boundingBox;O?E(O):W.getCapabilities({done:function(e,t){try{var n=x.layers||W.wmsParams.layers,r=e.getElementsByTagName("Capability")[0].getElementsByTagName("Layer")[0],o=r.getElementsByTagName("Layer"),i=[];if(o&&0<o.length&&n&&0<n.length){for(var a=n.split(","),l=[],s=0,u=a.length;s<u;s++){var c=(c=a[s].split(":"))[1]||c[0];l.push(c)}for(var f=0,m=o.length;f<m;f++){var p=o[f],g=L.TileLayer.WMS.Util.XML.getElementText(p.getElementsByTagName("Name")[0]);0<=l.indexOf(g)&&i.push(p)}}else i.push(r);for(var y=0,d=i.length;y<d;y++){var h,S,T,M,w=i[y];v=!W.wmsParams.version||1.3<=W.wmsParams.version||"1.3.0"===W.wmsParams.version?(h=w.getElementsByTagName("EX_GeographicBoundingBox")[0],S=L.TileLayer.WMS.Util.XML.getElementText(h.getElementsByTagName("westBoundLongitude")[0]),T=L.TileLayer.WMS.Util.XML.getElementText(h.getElementsByTagName("eastBoundLongitude")[0]),M=L.TileLayer.WMS.Util.XML.getElementText(h.getElementsByTagName("southBoundLatitude")[0]),L.TileLayer.WMS.Util.XML.getElementText(h.getElementsByTagName("northBoundLatitude")[0])):(S=(v=w.getElementsByTagName("LatLonBoundingBox")[0]).getAttribute("minx"),T=v.getAttribute("maxx"),M=v.getAttribute("miny"),v.getAttribute("maxy"));var v=L.latLngBounds(L.latLng(M,S),L.latLng(v,T));O=O?O.extend(v):v}W._boundingBox=O,E(O,t)}catch(e){N(e,t)}},fail:N})}}),L.TileLayer.WMS.include({_capabilities:null,getCapabilities:function(n){n=L.Util.extend({fail:function(e){throw e}},n||{});function r(e,t){"function"==typeof n.done&&n.done.call(i,e,t),"function"==typeof n.always&&n.always.call(i)}function o(e,t){"function"==typeof n.fail&&n.fail.call(i,e,t),"function"==typeof n.always&&n.always.call(i)}var i=this,e=i._capabilities;e?r(e):L.TileLayer.WMS.Util.AJAX({url:i._url,method:"GET",content:{request:"GetCapabilities",service:"WMS",version:i.wmsParams.version},done:function(e,t){try{var n=L.TileLayer.WMS.Util.XML.ExceptionReport.parse(e);if(n)throw new Error(n.message);n=L.TileLayer.WMS.Util.XML.parse(e);i._capabilities=n,r(n,t)}catch(e){o(e,t)}},fail:o})}}),L.TileLayer.WMS.include({_infoFormat:null,getInfoFormat:function(n){n=L.Util.extend({fail:function(e){throw e}},n||{});function l(e,t){"function"==typeof n.done&&n.done.call(u,e,t),"function"==typeof n.always&&n.always.call(u)}function s(e,t){"function"==typeof n.fail&&n.fail.call(u,e,t),"function"==typeof n.always&&n.always.call(u)}var u=this,c=u._infoFormat;c?l(c):u.getCapabilities({done:function(e,t){try{for(var n=L.TileLayer.WMS.Format.getExisting(),r=L.TileLayer.WMS.Util.XML.extractInfoFormats(e),o=0,i=n.length;o<i;o++){var a=n[o];if(0<=r.indexOf(a)){c=a;break}}u._infoFormat=c,l(c,t)}catch(e){s(e,t)}},fail:s})}}),L.TileLayer.WMS.include({getFeatureInfo:function(u){u=L.Util.extend({featureCount:1,fail:function(e){throw e}},u||{});function c(e,t){"function"==typeof u.fail&&u.fail.call(f,e,t),"function"==typeof u.always&&u.always.call(f)}var f=this;(u.infoFormat?function(e){e.done(u.infoFormat)}:f.getInfoFormat).call(f,{done:function(o,e){try{if(!o)throw l="None of available formats for '"+f._url+"' 'GetFeatureInfo' requests are not implemented in 'L.TileLayer.WMS'. 'GetFeatureInfo' request can't be performed.",new Error(l);if(!L.TileLayer.WMS.Format[o])throw l="Format '"+o+"' ' is not implemented in 'L.TileLayer.WMS'. 'GetFeatureInfo' request can't be performed.",new Error(l);var t=f._map||u.map,n=u.latlng,r=t.latLngToContainerPoint(n,t.getZoom()),i=t.getSize(),a=f.options.crs||t.options.crs,l=t.getBounds(),n=a.project(l.getNorthWest()),t=a.project(l.getSouthEast()),l=u.featureCount||1,s={request:"GetFeatureInfo",service:"WMS",version:f.wmsParams.version,layers:f.wmsParams.layers,query_layers:f.wmsParams.layers,CQL_FILTER:f.wmsParams.CQL_FILTER,info_format:o,feature_count:l,height:i.y,width:i.x},i=window.parseFloat(f.wmsParams.version);s[1.3<=i?"crs":"srs"]=a.code,s.bbox=1.3<=i&&a===L.CRS.EPSG4326?t.y+","+n.x+","+n.y+","+t.x:n.x+","+t.y+","+t.x+","+n.y,s[1.3<=i?"i":"x"]=Math.round(r.x),s[1.3<=i?"j":"y"]=Math.round(r.y)}catch(e){return void c(e)}L.TileLayer.WMS.Util.AJAX({url:f._url,method:"GET",content:s,done:function(e,t){try{var n=L.TileLayer.WMS.Util.XML.ExceptionReport.parse(e);if(n)throw new Error(n.message);var r=L.TileLayer.WMS.Format[o].toGeoJSON(e);r.crs=a,n=r,r=t,"function"==typeof u.done&&u.done.call(f,n,r),"function"==typeof u.always&&u.always.call(f)}catch(e){c(e,t)}},fail:c})},fail:c})}})}(window,document);
